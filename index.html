<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>المدير المالي الشخصي</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
header{background:#1e88e5;color:#fff;padding:15px;text-align:center;font-size:22px}
.nav{display:flex}
.nav button{flex:1;padding:12px;border:none;background:#1565c0;color:#fff}
.nav button.active{background:#1e88e5}
.container{max-width:1100px;margin:auto;padding:15px}
.card{background:#fff;border-radius:12px;padding:15px;margin-bottom:15px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
input,select,button{width:100%;padding:10px;margin-top:8px;border-radius:8px;border:1px solid #ccc}
button{background:#1e88e5;color:#fff;border:none}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border-bottom:1px solid #ddd;padding:8px;text-align:center}
th{background:#f5f5f5}
.summary{display:flex;gap:10px}
.box{flex:1;background:#e3f2fd;padding:10px;border-radius:10px;text-align:center}
.income{color:green;font-weight:bold}
.expense{color:red;font-weight:bold}
.actionBtn{padding:4px 8px;margin:2px;border-radius:6px;font-size:14px}
.deleteBtn{background:#c62828}
</style>

</head>
<body>

<header>المدير المالي الشخصي</header>

<div class="nav">
<button class="active" onclick="show('finance')">العمليات</button>
<button onclick="show('debts')">الديون</button>
</div>

<div class="container">

<!-- العمليات -->
<div id="finance">
<div class="card">

<select id="mainType">
  <option value="income">دخل</option>
  <option value="expense">خرج</option>
</select>

<select id="subType">
  <option value="normal">عادي</option>
  <option value="debt">دين</option>
</select>

<input id="desc" placeholder="الوصف / اسم الشخص">
<input id="amount" type="number" placeholder="المبلغ">

<button onclick="addTransaction()">إضافة عملية</button>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>النوع</th>
<th>الوصف</th>
<th>المبلغ</th>
<th>التاريخ</th>
<th>إجراء</th>
</tr>
</thead>
<tbody id="transactionList"></tbody>
</table>
</div>

<div class="summary">
<div class="box income">الدخل<br><span id="totalIncome">0</span></div>
<div class="box expense">الخرج<br><span id="totalExpense">0</span></div>
<div class="box">الرصيد<br><span id="balance">0</span></div>
</div>
</div>

<!-- الديون -->
<div id="debts" style="display:none">
<div class="card">
<table>
<thead>
<tr>
<th>الاسم</th>
<th>المبلغ</th>
<th>النوع</th>
<th>إجراء</th>
</tr>
</thead>
<tbody id="debtList"></tbody>
</table>
</div>
</div>

</div>

<script>
let transactions = JSON.parse(localStorage.getItem('finance')) || [];
let debts = JSON.parse(localStorage.getItem('debts')) || [];

function show(id){
document.getElementById('finance').style.display = id === 'finance' ? 'block' : 'none';
document.getElementById('debts').style.display = id === 'debts' ? 'block' : 'none';
}

function addTransaction(){
if(!desc.value || amount.value <= 0) return;

const d = new Date();
const type = mainType.value;
const sub = subType.value;

transactions.push({
type,
desc: desc.value,
amount: Number(amount.value),
date: d.toLocaleDateString('ar-EG')
});

if(sub === 'debt'){
debts.push({
name: desc.value,
amount: Number(amount.value),
type: type === 'income' ? 'أنت مدين' : 'مدين لك'
});
}

save();
desc.value = '';
amount.value = '';
renderAll();
}

function renderTransactions(){
transactionList.innerHTML = '';
let inc = 0, exp = 0;

transactions.forEach((t,i)=>{
transactionList.innerHTML += `
<tr>
<td>${t.type === 'income' ? 'دخل' : 'خرج'}</td>
<td>${t.desc}</td>
<td>${t.amount}</td>
<td>${t.date}</td>
<td><button class="actionBtn deleteBtn" onclick="delT(${i})">حذف</button></td>
</tr>`;
t.type === 'income' ? inc += t.amount : exp += t.amount;
});

totalIncome.textContent = inc;
totalExpense.textContent = exp;
balance.textContent = inc - exp;
}

function renderDebts(){
debtList.innerHTML = '';
debts.forEach((d,i)=>{
debtList.innerHTML += `
<tr>
<td>${d.name}</td>
<td>${d.amount}</td>
<td>${d.type}</td>
<td><button class="actionBtn deleteBtn" onclick="delD(${i})">حذف</button></td>
</tr>`;
});
}

function delT(i){
transactions.splice(i,1);
save();
renderAll();
}

function delD(i){
debts.splice(i,1);
save();
renderAll();
}

function save(){
localStorage.setItem('finance', JSON.stringify(transactions));
localStorage.setItem('debts', JSON.stringify(debts));
}

function renderAll(){
renderTransactions();
renderDebts();
}

renderAll();
</script>

</body>
</html>
